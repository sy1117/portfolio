import e,{forwardRef as r,useEffect as t,Fragment as n}from"react";import{useFormContext as a,useForm as o,FormProvider as s}from"react-hook-form";import i from"moment";function u(){return(u=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function l(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r.indexOf(t=o[n])>=0||(a[t]=e[t]);return a}function c(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var f=function(e,r,t){return{required:r+" 을(를) 입력해주세요.",min:r+" 은(는) "+t+" 보다 커야 합니다.",max:r+" 은(는) "+t+" 보다 작아야 합니다.",maxLength:r+" 은(는) "+t+"자 이내로 작성해주세요.",minLength:r+" 은(는) "+t+" 자 이상이어야 합니다.",pattern:r+" 이(가) 형식에 맞지 않습니다.",validate:r+" 이(가) 유효하지 않습니다.",equal:r+" 이(가) "+t+" 와 일치하지 않습니다.",notEqual:r+" 은(는) "+t+" 와 같을 수 없습니다.",greaterThan:r+" 은(는) "+t+" 보다 커야 합니다.",greaterThanOrEqual:r+" 은(는) "+t+" 보다 크거나 같아야 합니다",lessThan:r+" 은(는) "+t+" 보다 작아야 합니다.",lessThanOrEqual:r+" 은(는) "+t+" 보다 작거나 같아야 합니다"}[e]},m=function(e,r,t){for(var n={},a=0,o=Object.entries(t);a<o.length;a++){var s=o[a],i=s[0],l=s[1];switch(typeof l){case"boolean":n[i]=f(i,e||r);break;case"string":n[i]={value:i,message:l};break;case"number":n[i]={value:l,message:f(i,e||r,l)};break;case"object":n[i]=u({},l,l.message?{message:l.message}:{message:f(i,e||r,l)});break;default:n[i]=l}}return n},d={equal:function(e,r,t){var n=t.name,a=t.message;return function(r){return r===e.getValues()[n]||a}},notEqual:function(e,r,t){var n=t.name,a=t.message;return function(r){return r!==e.getValues()[n]||a}},greaterThan:function(e,r,t){var n=t.name,a=t.message;return function(t){var o=e.getValues()[n];return"date"===r?i(t).isAfter(o)||a:parseInt(t)>o||a}},greaterThanOrEqual:function(e,r,t){var n=t.name,a=t.message;return function(t){var o=e.getValues()[n];return"date"===r?i(t).isSameOrAfter(o)||a:parseInt(t)>=o||a}},lessThan:function(e,r,t){var n=t.name,a=t.message;return function(t){var o=e.getValues()[n];return"date"===r?i(t).isBefore(o)||a:parseInt(t)<o||a}},lessThanOrEqual:function(e,r,t){var n=t.name,a=t.message;return function(t){var o=e.getValues()[n];return"date"===r?i(t).isSameOrBefore(o)||a:parseInt(t)<=parseInt(o)||a}}},g={text:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"text"},n,{ref:t}))}),date:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"date"},n,{ref:t}))}),password:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"password"},n,{ref:t}))}),number:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"number"},n,{ref:t}))}),hidden:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"hidden"},n,{ref:t}))}),email:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"email"},n,{ref:t}))}),checkbox:r(function(r,t){var n=u({},r);return e.createElement("input",Object.assign({type:"checkbox"},n,{ref:t}))}),select:r(function(r,t){var n=u({},r);return e.createElement("select",Object.assign({},n,{ref:t}))}),textarea:r(function(r,t){var n=u({},r);return e.createElement("textarea",Object.assign({},n,{ref:t}))})},v=function(r){var t=r.name,n=r.rules,o=r.type,s=r.label,i=r.placeholder,c=r.props,f=r.className,v=l(r,["name","rules","type","label","placeholder","props","className"]),p=a(),b=p.control,h=p.errors,y=p.register,O=p.getValues;if(n&&(n=function(e,r,t){var n={},a={};if(t){if(t.validate)return t;for(var o=0,s=Object.entries(t);o<s.length;o++){var i=s[o],u=i[0],l=i[1];"equal"===u||"notEqual"===u||"greaterThan"===u||"greaterThanOrEqual"===u||"lessThan"===u||"lessThanOrEqual"===u?a.lessThan=d[u](e,r,l):n[u]=l}}return n.validate=a,n}(b,o,n=m(s||i||"",t||"",n))),"string"==typeof o){var E,j=function(e){return g[e]}(o);return t&&"content"===o&&(c=u({},c,{data:O()})),t&&h[t]&&(c=u({},c,{error:!0,helperText:"object"===h[t]&&Array.isArray(h[t])?h[t]:null===(E=h[t])||void 0===E?void 0:E.message})),e.createElement(j,Object.assign({ref:y(n),className:f,name:t},s&&{label:s},i&&{placeholder:i},c,v))}return e.createElement(o,Object.assign({name:t,label:s,data:O(),control:b},c,v))},p=function(r){var a=r.mode,i=void 0===a?"create":a,f=r.validate,d=void 0===f?"onSubmit":f,g=r.data,p=r.fields,b=r.onChange,h=r.onSubmit,y=r.children,O=r.forceDirtyFields,E=l(r,["mode","validate","data","compareFields","fields","onChange","onSubmit","children","forceDirtyFields"]),j=o({defaultValues:g,mode:d});t(function(){j.reset(g)},[g]);var x=j.formState.dirtyFields,T=j.getValues,S=j.errors;return e.createElement(s,Object.assign({},j),e.createElement("form",Object.assign({onSubmit:j.handleSubmit(function(e){if("create"===i)h(e);else{var r={};Object.keys(x).forEach(function(t){r[t]=e[t]}),(O||[]).forEach(function(t){r[t]=e[t]});for(var t,n=function(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return c(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?c(e,void 0):void 0}}(e))){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}(j.control.fieldArrayNamesRef.current);!(t=n()).done;){var a=t.value;r[a]=e[a]}h(r)}}),onChange:function(e){var r={};b&&(Object.keys(S).forEach(function(e){r[e]={}}),b(e,T(),r))}},E),p.map(function(r,t){var a=v;return r.rules=m(r.label||r.placeholder||"",r.name,r.rules||{}),r.hiddenIf&&r.hiddenIf.indexOf(i)>-1?e.createElement(n,null):(r.props=u({},r.props,{readOnly:"read"===i||r.readOnlyIf&&r.readOnlyIf.indexOf(i)>-1}),e.createElement(a,Object.assign({},r,{key:t})))}),y))};export default p;export{p as FormController};
//# sourceMappingURL=index.modern.js.map
